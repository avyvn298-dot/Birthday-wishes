<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adventure Game</title>
<style>
  body { margin:0; background:#04121a; color:#e8fbff; font-family:Courier, monospace; overflow:hidden; }
  canvas { display:block; margin:0 auto; background:#04121a; }
  #hud { position:fixed; top:10px; left:10px; z-index:10; }
  #dialogue { position:fixed; bottom:20px; left:50%; transform:translateX(-50%); width:80%; max-width:600px; background:rgba(0,0,0,0.6); padding:12px 16px; border-radius:12px; display:none; color:white; }
  #dialogueChoices button { margin-right:8px; }
  #dialogueContinue { margin-top:8px; cursor:pointer; }
</style>
</head>
<body>

<div id="hud">
  <div id="score">Score: 0 / 17</div>
  <div id="playerName">Player</div>
</div>

<div id="dialogue">
  <div id="dialogueText"></div>
  <div id="dialogueChoices"></div>
  <div id="dialogueContinue">[Click to continue]</div>
</div>

<canvas id="game" width="800" height="500"></canvas>

<script>
/* ===========================
   CONFIG & CONSTANTS
   =========================== */
const NAME = "Abdullah Naveed";
const TARGET_SCORE = 17;
const SHIRT_COLOR = "#2a9df4";
const HAIR_COLOR = "#2b1a0e";
const SKIN_COLOR = "#f0d6b6";

/* Difficulty / tuning */
let DIFFICULTY = 1.0;

/* Player / physics */
const PLAYER_SPEED = 3.6;
const JUMP_SPEED = -11;
const GRAVITY = 0.6;
let ASSIST_ON = false;
let MUSIC_ON = true;

/* ===========================
   DOM REFERENCES
   =========================== */
const dialogue = document.getElementById('dialogue');
const dialogueText = document.getElementById('dialogueText');
const dialogueChoices = document.getElementById('dialogueChoices');
const dialogueContinue = document.getElementById('dialogueContinue');
const hud = document.getElementById('hud');
const scoreEl = document.getElementById('score');
const playerNameEl = document.getElementById('playerName');
playerNameEl.textContent = NAME;

const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d', { alpha: false });
let canvasW = canvas.width, canvasH = canvas.height;
let cameraX = 0;
let lastTime = 0;
let running = false;

/* Player */
const player = { x:80, y:300, vx:0, vy:0, w:16, h:24, onGround:false, score:0, drawY:300 };

/* World objects */
const WORLD_W = 1600;
let platforms = [];
let items = [];
let enemies = [];

/* ===========================
   SPRITES & PALETTES
   =========================== */
const heroSprite = [
  [0,1,1,1,0],
  [1,2,2,2,1],
  [0,3,4,3,0],
  [0,4,4,4,0]
];

function heroPalette(){ return [null, SKIN_COLOR, HAIR_COLOR, SKIN_COLOR, SHIRT_COLOR, "#1b1b1b"]; }

function drawPixelSprite(sprite, palette, dx, dy, scale=3){
  for (let yy=0; yy<sprite.length; yy++){
    for (let xx=0; xx<sprite[0].length; xx++){
      const v = sprite[yy][xx];
      if (!v) continue;
      ctx.fillStyle = palette[v];
      ctx.fillRect(Math.round(dx + xx*scale), Math.round(dy + yy*scale), scale, scale);
    }
  }
}

/* ===========================
   HELPER FUNCTIONS
   =========================== */
function worldToScreen(wx){ return Math.round(wx - cameraX); }
function rectsOverlap(ax,ay,aw,ah,bx,by,bw,bh){ return ax < bx+bw && ax+aw > bx && ay<by+bh && ay+ah > by; }

function showFloatingText(text, worldX){
  const el = document.createElement('div');
  el.textContent = text; el.style.position='fixed';
  const sx = Math.max(40, Math.min(window.innerWidth-160, worldToScreen(worldX)+60));
  el.style.left = sx+'px';
  el.style.top = (window.innerHeight*0.18)+'px';
  el.style.background='rgba(255,255,255,0.06)';
  el.style.padding='8px 12px';
  el.style.borderRadius='8px';
  el.style.pointerEvents='none';
  el.style.fontFamily='Courier New';
  document.body.appendChild(el);
  setTimeout(()=>{ el.style.transition='opacity .25s'; el.style.opacity=0; setTimeout(()=>el.remove(),300); },1000);
}

/* ===========================
   WORLD & ITEMS
   =========================== */
function makeWorld(){
  platforms = [
    {x:0, y:440, w: WORLD_W, h:80},
    {x:120, y:360, w:220, h:16},
    {x:420, y:300, w:160, h:16},
    {x:620, y:240, w:180, h:16},
    {x:880, y:320, w:180, h:16},
    {x:1160, y:260, w:200, h:16},
    {x:1360, y:340, w:200, h:16}
  ];

  items = [];
  const collectibleTypes = ['gift','cake'];
  platforms.forEach((p,i)=>{
    if (i===0) return;
    const spots = Math.max(1, Math.floor(p.w/120));
    for (let s=0;s<spots;s++){
      const px = p.x + 30 + s*(p.w/spots);
      const t = collectibleTypes[(s+i)%collectibleTypes.length];
      items.push({x: px + (Math.random()*30-15), y: p.y - (8*3) - (Math.random()*6), type: t, picked:false});
    }
  });

  enemies = [
    {x:500, y:260, vx:1.2*DIFFICULTY, range:[480,720]},
    {x:980, y:280, vx:1.4*DIFFICULTY, range:[920,1200]},
    {x:1320, y:300, vx:1.1*DIFFICULTY, range:[1260,1440]}
  ];
}

/* ===========================
   DRAW & UPDATE
   =========================== */
function draw(){
  ctx.fillStyle="#04121a"; ctx.fillRect(0,0,canvasW,canvasH);

  // platforms
  for (let p of platforms){
    const sx=worldToScreen(p.x), sy=p.y, sw=p.w, sh=p.h;
    ctx.fillStyle="#08303f"; ctx.fillRect(sx,sy,sw,sh);
    ctx.fillStyle="#0d4960"; ctx.fillRect(sx,sy,sw,6);
  }

  // player
  drawPixelSprite(heroSprite, heroPalette(), worldToScreen(player.x), player.drawY, 3);

  ctx.fillStyle="#e8fbff"; ctx.font="16px Courier New";
  ctx.fillText(`Score: ${player.score} / ${TARGET_SCORE}`,10,22);
  ctx.fillText(NAME, canvasW-220,22);
}

function update(dt){
  player.x += player.vx * PLAYER_SPEED;
  player.x = Math.max(6, Math.min(player.x, WORLD_W - player.w - 6));

  player.vy += GRAVITY;
  player.y += player.vy;
  player.onGround=false;

  for (let p of platforms){
    if (rectsOverlap(player.x, player.y, player.w, player.h, p.x, p.y, p.w, p.h)){
      if (player.vy>0 && (player.y+player.h-player.vy)<=p.y+6){
        player.y=p.y-player.h;
        player.vy=0; player.onGround=true;
      }
    }
  }
  player.drawY=Math.round(player.y);

  const center=canvasW/2;
  const targetCam=Math.max(0, Math.min(player.x-center+player.w/2, WORLD_W-canvasW));
  cameraX += (targetCam-cameraX)*0.12;
}

function loop(t){ if(!running) return; if(!lastTime) lastTime=t; const dt=t-lastTime; lastTime=t; update(dt); draw(); requestAnimationFrame(loop); }

function resizeCanvas(){ canvasW=canvas.width=Math.min(920,Math.floor(window.innerWidth*0.94)); canvasH=canvas.height=Math.floor(canvasW*0.63); }
window.addEventListener('resize', ()=>{ resizeCanvas(); draw(); });
resizeCanvas();

/* ===========================
   START GAME
   =========================== */
makeWorld();
running=true;
requestAnimationFrame(loop);
</script>

</body>
</html>
